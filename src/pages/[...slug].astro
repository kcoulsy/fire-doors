---
import type { GetStaticPaths, GetStaticPathsResult } from "astro";
import { LOCATIONS } from "../constants/locations";
import FireDoorServicesPage from "../components/FireDoorServicesPage.astro";
import FireDoorMaintenancePage from "../components/FireDoorMaintenancePage.astro";
import FireDoorInspectorsPage from "../components/FireDoorInspectorsPage.astro";
import FireDoorInstallersPage from "../components/FireDoorInstallersPage.astro";

export const getStaticPaths = (() => {
  const paths: GetStaticPathsResult = [];

  LOCATIONS.forEach(({ slug }) => {
    paths.push({
      params: {
        slug: `${slug}-fire-door-services`,
      },
    });
  });

  LOCATIONS.forEach(({ slug }) => {
    paths.push({
      params: {
        slug: `${slug}-fire-door-inspectors`,
      },
    });
  });

  LOCATIONS.forEach(({ slug }) => {
    paths.push({
      params: {
        slug: `${slug}-fire-door-installers`,
      },
    });
  });

  LOCATIONS.forEach(({ slug }) => {
    paths.push({
      params: {
        slug: `${slug}-fire-door-maintenance`,
      },
    });
  });

  return paths;
}) satisfies GetStaticPaths;

const { slug } = Astro.params;
const slugStr = typeof slug === "string" ? slug : "";

// Parse the slug to extract location and type
const parts = slugStr.split("-");
const serviceTypes = [
  "fire-door-services",
  "fire-door-inspectors",
  "fire-door-installers",
  "fire-door-maintenance",
];

let location = "";
let type = "";

// Find the service type in the slug
for (const serviceType of serviceTypes) {
  if (slugStr.endsWith(`-${serviceType}`)) {
    type = serviceType;
    location = slugStr.slice(0, -(serviceType.length + 1)); // Remove the service type and the hyphen
    break;
  }
}
---

{
  type === "fire-door-services" && (
    <FireDoorServicesPage location={location} type={type} />
  )
}
{
  type === "fire-door-maintenance" && (
    <FireDoorMaintenancePage location={location} type={type} />
  )
}
{
  type === "fire-door-inspectors" && (
    <FireDoorInspectorsPage location={location} type={type} />
  )
}
{
  type === "fire-door-installers" && (
    <FireDoorInstallersPage location={location} type={type} />
  )
}
